import{createRequire as Y} from"node:module";var j=Object.create;var{defineProperty:q,getPrototypeOf:n,getOwnPropertyNames:z}=Object;var H=Object.prototype.hasOwnProperty;var K=(t,o,w)=>{w=t!=null?j(n(t)):{};const u=o||!t||!t.__esModule?q(w,"default",{value:t,enumerable:!0}):w;for(let i of z(t))if(!H.call(u,i))q(u,i,{get:()=>t[i],enumerable:!0});return u};var V=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports);var s=Y(import.meta.url);var Z=V((p,B)=>{var c=function(t,o){var w=o||{},u=w.type||"attachment",i=A(t,w.fallback);return C(new M(u,i))},A=function(t,o){if(t===void 0)return;var w={};if(typeof t!=="string")throw new TypeError("filename must be a string");if(o===void 0)o=!0;if(typeof o!=="string"&&typeof o!=="boolean")throw new TypeError("fallback must be a string or boolean");if(typeof o==="string"&&J.test(o))throw new TypeError("fallback must be ISO-8859-1 string");var u=y(t),i=D.test(u),r=typeof o!=="string"?o&&W(u):y(o),$=typeof r==="string"&&r!==u;if($||!i||I.test(u))w["filename*"]=u;if(i||$)w.filename=$?r:u;return w},C=function(t){var{parameters:o,type:w}=t;if(!w||typeof w!=="string"||!L.test(w))throw new TypeError("invalid type");var u=String(w).toLowerCase();if(o&&typeof o==="object"){var i,r=Object.keys(o).sort();for(var $=0;$<r.length;$++){i=r[$];var d=i.substr(-1)==="*"?X(o[i]):R(o[i]);u+="; "+i+"="+d}}return u},N=function(t){var o=O.exec(t);if(!o)throw new TypeError("invalid extended field value");var w=o[1].toLowerCase(),u=o[2],i,r=u.replace(Q,G);switch(w){case"iso-8859-1":i=W(r);break;case"utf-8":i=U.from(r,"binary").toString("utf8");break;default:throw new TypeError("unsupported charset in extended field")}return i},W=function(t){return String(t).replace(J,"?")},v=function(t){if(!t||typeof t!=="string")throw new TypeError("argument string is required");var o=h.exec(t);if(!o)throw new TypeError("invalid type format");var w=o[0].length,u=o[1].toLowerCase(),i,r=[],$={},d;w=F.lastIndex=o[0].substr(-1)===";"?w-1:w;while(o=F.exec(t)){if(o.index!==w)throw new TypeError("invalid parameter format");if(w+=o[0].length,i=o[1].toLowerCase(),d=o[2],r.indexOf(i)!==-1)throw new TypeError("invalid duplicate parameter");if(r.push(i),i.indexOf("*")+1===i.length){i=i.slice(0,-1),d=N(d),$[i]=d;continue}if(typeof $[i]==="string")continue;if(d[0]==='"')d=d.substr(1,d.length-2).replace(S,"$1");$[i]=d}if(w!==-1&&w!==t.length)throw new TypeError("invalid parameter format");return new M(u,$)},G=function(t,o){return String.fromCharCode(parseInt(o,16))},P=function(t){return"%"+String(t).charCodeAt(0).toString(16).toUpperCase()},R=function(t){var o=String(t);return'"'+o.replace(T,"\\$1")+'"'},X=function(t){var o=String(t),w=encodeURIComponent(o).replace(x,P);return"UTF-8\'\'"+w},M=function(t,o){this.type=t,this.parameters=o};/*!
 * content-disposition
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */B.exports=c;B.exports.parse=v;var y=s("path").basename,U=s("safe-buffer").Buffer,x=/[\x00-\x20"'()*,/:;<=>?@[\\\]{}\x7f]/g,I=/%[0-9A-Fa-f]{2}/,Q=/%([0-9A-Fa-f]{2})/g,J=/[^\x20-\x7e\xa0-\xff]/g,S=/\\([\u0000-\u007f])/g,T=/([\\"])/g,F=/;[\x09\x20]*([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*=[\x09\x20]*("(?:[\x20!\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*/g,D=/^[\x20-\x7e\x80-\xff]+$/,L=/^[!#$%&'*+.0-9A-Z^_`a-z|~-]+$/,O=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+.^_`|~-])+)$/,h=/^([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*(?:$|;)/});var g=K(Z(),1);import{mkdirSync as f,writeFileSync as b} from"node:fs";async function E(t){try{const o=await fetch("https://api.cobalt.tools/api/json",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok)throw Error(`HTTP Error: ${o.status} ${o.statusText}`);return await o.json()}catch(o){throw Error("Error: ",{cause:o})}}async function l(t){try{const o=await fetch(t),w=g.default.parse(o.headers.get("Content-Disposition")).parameters.filename;f("./downloaded/",{recursive:!0}),console.log(`Writing file...: ${w}`),b(`./downloaded/${w}`,new Uint8Array(await o.arrayBuffer())),console.log(`File written successfully: ./downloaded/${w}`)}catch(o){throw Error("Error: ",{cause:o})}}export{E as request,l as download};
